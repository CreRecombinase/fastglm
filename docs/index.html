<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting fast generalized linear models using 'RcppEigen' • fastglm</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fitting fast generalized linear models using 'RcppEigen'">
<meta property="og:description" content="Fits generalized linear models efficiently using 'RcppEigen'. The iteratively reweighted least squares 
    implementation utilizes the step-halving approach of Marschner (2011) &lt;10.32614/RJ-2011-012&gt; to help safeguard
    against convergence issues.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">fastglm</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/quick-usage-guide-to-the-fastglm-package.html">Quick Usage Guide to the 'fastglm' Package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    

<div id="overview-of-fastglm" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#overview-of-fastglm" class="anchor"></a>Overview of ‘fastglm’</h1></div>
<p>The ‘fastglm’ package is a re-write of <code>glm()</code> using <code>RcppEigen</code> designed to be computationally efficient.</p>
</div>
<div id="installing-the-fastglm-package" class="section level1">
<h1 class="hasAnchor">
<a href="#installing-the-fastglm-package" class="anchor"></a>Installing the ‘fastglm’ package</h1>
<p>Install the development version using the <strong>devtools</strong> package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"jaredhuling/fastglm"</span>)</a></code></pre></div>
<p>or by cloning and building using <code>R CMD INSTALL</code></p>
</div>
<div id="quick-usage-overview" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-usage-overview" class="anchor"></a>Quick Usage Overview</h1>
<p>Load the package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(fastglm)</a></code></pre></div>
<p>A (not comprehensive) comparison with <code>glm.fit()</code> and <code><a href="http://www.rdocumentation.org/packages/speedglm/topics/speedglm">speedglm.wfit()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(speedglm)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">n.obs  &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">n.vars &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n.obs <span class="op">*</span><span class="st"> </span>n.vars, <span class="dt">sd =</span> <span class="dv">3</span>), n.obs, n.vars)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">Sigma &lt;-<span class="st"> </span><span class="fl">0.99</span> <span class="op">^</span><span class="st"> </span><span class="kw">abs</span>(<span class="kw">outer</span>(<span class="dv">1</span><span class="op">:</span>n.vars, <span class="dv">1</span><span class="op">:</span>n.vars, <span class="dt">FUN =</span> <span class="st">"-"</span>))</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">x &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/MASS/topics/mvrnorm">mvrnorm</a></span>(n.obs, <span class="dt">mu =</span> <span class="kw">runif</span>(n.vars, <span class="dt">min =</span> <span class="dv">-1</span>), <span class="dt">Sigma =</span> Sigma)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">y &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>( <span class="kw">drop</span>(x[,<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>] <span class="op">%*%</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">25</span>, <span class="dt">min =</span> <span class="fl">-0.1</span>, <span class="dt">max =</span> <span class="fl">0.10</span>)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">rnorm</span>(n.obs))</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">ct &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/microbenchmark/topics/microbenchmark">microbenchmark</a></span>(</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">    <span class="dt">glm.fit =</span> {gl1 &lt;-<span class="st"> </span><span class="kw">glm.fit</span>(x, y, <span class="dt">family =</span> <span class="kw">binomial</span>())},</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">    <span class="dt">speedglm.eigen  =</span> {sg1 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/speedglm/topics/speedglm">speedglm.wfit</a></span>(y, x, <span class="dt">intercept =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">                                            <span class="dt">family =</span> <span class="kw">binomial</span>())},</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">    <span class="dt">speedglm.chol   =</span> {sg2 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/speedglm/topics/speedglm">speedglm.wfit</a></span>(y, x, <span class="dt">intercept =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb3-19" data-line-number="19">                                            <span class="dt">family =</span> <span class="kw">binomial</span>(), <span class="dt">method =</span> <span class="st">"Chol"</span>)},</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">    <span class="dt">speedglm.qr     =</span> {sg3 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/speedglm/topics/speedglm">speedglm.wfit</a></span>(y, x, <span class="dt">intercept =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">                                            <span class="dt">family =</span> <span class="kw">binomial</span>(), <span class="dt">method =</span> <span class="st">"qr"</span>)},</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">    <span class="dt">fastglm.qr.cpiv =</span> {gf1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/fastglm.html">fastglm</a></span>(x, y, <span class="dt">family =</span> <span class="kw">binomial</span>())},</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">    <span class="dt">fastglm.qr      =</span> {gf2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/fastglm.html">fastglm</a></span>(x, y, <span class="dt">family =</span> <span class="kw">binomial</span>(), <span class="dt">method =</span> <span class="dv">1</span>)},</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">    <span class="dt">fastglm.LLT     =</span> {gf3 &lt;-<span class="st"> </span><span class="kw"><a href="reference/fastglm.html">fastglm</a></span>(x, y, <span class="dt">family =</span> <span class="kw">binomial</span>(), <span class="dt">method =</span> <span class="dv">2</span>)},</a>
<a class="sourceLine" id="cb3-25" data-line-number="25">    <span class="dt">fastglm.LDLT    =</span> {gf4 &lt;-<span class="st"> </span><span class="kw"><a href="reference/fastglm.html">fastglm</a></span>(x, y, <span class="dt">family =</span> <span class="kw">binomial</span>(), <span class="dt">method =</span> <span class="dv">3</span>)},</a>
<a class="sourceLine" id="cb3-26" data-line-number="26">    <span class="dt">fastglm.qr.fpiv =</span> {gf5 &lt;-<span class="st"> </span><span class="kw"><a href="reference/fastglm.html">fastglm</a></span>(x, y, <span class="dt">family =</span> <span class="kw">binomial</span>(), <span class="dt">method =</span> <span class="dv">4</span>)},</a>
<a class="sourceLine" id="cb3-27" data-line-number="27">    <span class="dt">times =</span> 25L</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">)</a>
<a class="sourceLine" id="cb3-29" data-line-number="29"></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span>(ct, <span class="dt">log =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span>(<span class="dt">fun.y =</span> median, <span class="dt">geom =</span> <span class="st">'point'</span>, <span class="dt">size =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="articles/gen_data-1.png" width="100%"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># comparison of estimates</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(gl1) <span class="op">-</span><span class="st"> </span>gf1<span class="op">$</span>coef))</a></code></pre></div>
<pre><code>## [1] 2.590289e-14</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(gl1) <span class="op">-</span><span class="st"> </span>gf2<span class="op">$</span>coef))</a></code></pre></div>
<pre><code>## [1] 2.546921e-14</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(gl1) <span class="op">-</span><span class="st"> </span>gf3<span class="op">$</span>coef))</a></code></pre></div>
<pre><code>## [1] 1.140078e-13</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(gl1) <span class="op">-</span><span class="st"> </span>gf4<span class="op">$</span>coef))</a></code></pre></div>
<pre><code>## [1] 1.094264e-13</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(gl1) <span class="op">-</span><span class="st"> </span>gf5<span class="op">$</span>coef))</a></code></pre></div>
<pre><code>## [1] 2.776945e-14</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># now between glm and speedglm</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(gl1) <span class="op">-</span><span class="st"> </span>sg1<span class="op">$</span>coef))</a></code></pre></div>
<pre><code>## [1] 1.359413e-12</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(gl1) <span class="op">-</span><span class="st"> </span>sg2<span class="op">$</span>coef))</a></code></pre></div>
<pre><code>## [1] 1.359413e-12</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(gl1) <span class="op">-</span><span class="st"> </span>sg3<span class="op">$</span>coef))</a></code></pre></div>
<pre><code>## [1] 1.191977e-12</code></pre>
</div>
<div id="stability" class="section level1">
<h1 class="hasAnchor">
<a href="#stability" class="anchor"></a>Stability</h1>
<p>The <code>fastglm</code> package does not compromise computational stability for speed. In fact, for many situations where <code>glm()</code> and even <code>glm2()</code> do not converge, <code><a href="reference/fastglm.html">fastglm()</a></code> does converge.</p>
<p>As an example, consider the following data scenario, where the response distribution is (mildly) misspecified, but the link function is quite badly misspecified. In such scenarios, the standard IRLS algorithm tends to have convergence issues. The <code>glm2()</code> package was designed to handle such cases, however, it still can have convergence issues. The <code><a href="reference/fastglm.html">fastglm()</a></code> package uses a similar step-halving technique as <code>glm2()</code>, but it starts at better initialized values and thus tends to have better convergence properties in practice.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">10000</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">ncol =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">y &lt;-<span class="st"> </span>(<span class="kw">exp</span>(<span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span>x[,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span>x[,<span class="dv">3</span>] <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x[,<span class="dv">4</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x[,<span class="dv">5</span>] <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10000</span>)) ) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="kw">system.time</span>(gfit1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/fastglm.html">fastglm</a></span>(<span class="kw">cbind</span>(<span class="dv">1</span>, x), y, <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">"sqrt"</span>)))</a></code></pre></div>
<pre><code>##    user  system elapsed 
##   0.819   0.025   0.853</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">system.time</span>(gfit2 &lt;-<span class="st"> </span><span class="kw">glm</span>(y<span class="op">~</span>x, <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">"sqrt"</span>)) )</a></code></pre></div>
<pre><code>##    user  system elapsed 
##   2.836   0.095   2.938</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">system.time</span>(gfit3 &lt;-<span class="st"> </span>glm2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/glm2/topics/glm2">glm2</a></span>(y<span class="op">~</span>x, <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">"sqrt"</span>)) )</a></code></pre></div>
<pre><code>##    user  system elapsed 
##   2.287   0.076   2.375</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co">## Note that fastglm() returns estimates with the</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co">## largest likelihood</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw">logLik</span>(gfit1)</a></code></pre></div>
<pre><code>## 'log Lik.' -16030.81 (df=102)</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">logLik</span>(gfit2)</a></code></pre></div>
<pre><code>## 'log Lik.' -16704.05 (df=102)</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">logLik</span>(gfit3)</a></code></pre></div>
<pre><code>## 'log Lik.' -16046.66 (df=102)</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">coef</span>(gfit1)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a></code></pre></div>
<pre><code>##  (Intercept)           X1           X2           X3           X4 
##  1.429256009  0.125873599  0.005321164 -0.129389740  0.238937255</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">coef</span>(gfit2)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a></code></pre></div>
<pre><code>##   (Intercept)            x1            x2            x3            x4 
##  1.431168e+00  1.251936e-01 -6.896739e-05 -1.281857e-01  2.366473e-01</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">coef</span>(gfit3)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a></code></pre></div>
<pre><code>##   (Intercept)            x1            x2            x3            x4 
##  1.426864e+00  1.242616e-01 -9.860241e-05 -1.254873e-01  2.361301e-01</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co">## check convergence of fastglm</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2">gfit1<span class="op">$</span>converged</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co">## number of IRLS iterations</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">gfit1<span class="op">$</span>iter</a></code></pre></div>
<pre><code>## [1] 17</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co">## now check convergence for glm()</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">gfit2<span class="op">$</span>converged</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">gfit2<span class="op">$</span>iter</a></code></pre></div>
<pre><code>## [1] 25</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co">## check convergence for glm2()</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">gfit3<span class="op">$</span>converged</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">gfit3<span class="op">$</span>iter</a></code></pre></div>
<pre><code>## [1] 19</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co">## increasing number of IRLS iterations for glm() does not help that much</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="kw">system.time</span>(gfit2 &lt;-<span class="st"> </span><span class="kw">glm</span>(y<span class="op">~</span>x, <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">"sqrt"</span>), <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">maxit =</span> <span class="dv">100</span>)) )</a></code></pre></div>
<pre><code>##    user  system elapsed 
##  10.844   0.370  11.230</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">gfit2<span class="op">$</span>converged</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">gfit2<span class="op">$</span>iter</a></code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">logLik</span>(gfit1)</a></code></pre></div>
<pre><code>## 'log Lik.' -16030.81 (df=102)</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">logLik</span>(gfit2)</a></code></pre></div>
<pre><code>## 'log Lik.' -16054.15 (df=102)</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="https://github.com/jaredhuling/fastglm/issues">https://​github.com/​jaredhuling/​fastglm/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jared Huling <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/jaredhuling/fastglm"><img src="https://travis-ci.org/jaredhuling/fastglm.svg?branch=master" alt="Build Status"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jared Huling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
