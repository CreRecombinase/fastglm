<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick Usage Guide to the ‘fastglm’ Package • fastglm</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quick Usage Guide to the ‘fastglm’ Package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fastglm</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/quick-usage-guide-to-the-fastglm-package.html">Quick Usage Guide to the 'fastglm' Package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Quick Usage Guide to the ‘fastglm’ Package</h1>
                        <h4 class="author">Jared Huling</h4>
            
            <h4 class="date">2019-03-04</h4>
      
      
      <div class="hidden name"><code>quick-usage-guide-to-the-fastglm-package.Rmd</code></div>

    </div>

    
    
<p>The <code>fastglm</code> package is intended to be a <strong>fast</strong> <em>and</em> <strong>stable</strong> alternative to the <code>glm()</code> and <code>glm2()</code> functions for fitting generalized lienar models. The The <code>fastglm</code> package is compatible with <code>R</code>’s <code>family</code> objects (see <code>?family</code>). The package can be installed via</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"jaredhuling/fastglm"</span>)</a></code></pre></div>
<p>and loaded via:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(fastglm)</a></code></pre></div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>Currently, the <code>fastglm</code> package does not allow for formula-based data input and is restricted to matrices. We use the following example to demonstrate the usage of <code>fastglm</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">data</span>(esoph)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="kw">cbind</span>(ncases, ncontrols) <span class="op">~</span><span class="st"> </span>agegp <span class="op">+</span><span class="st"> </span><span class="kw">unclass</span>(tobgp)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                                         <span class="op">+</span><span class="st"> </span><span class="kw">unclass</span>(alcgp), <span class="dt">data =</span> esoph)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">y &lt;-<span class="st"> </span><span class="kw">cbind</span>(esoph<span class="op">$</span>ncases, esoph<span class="op">$</span>ncontrols)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">gfit1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fastglm.html">fastglm</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">"cloglog"</span>))</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw">summary</span>(gfit1)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; fastglm.default(x = x, y = y, family = binomial(link = "cloglog"))</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; Deviance Residuals: </span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; -1.8536  -0.6480  -0.2112   0.3562   2.1231  </span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;                Estimate Std. Error z value Pr(&gt;|z|)    </span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; (Intercept)    -3.75579    0.27555 -13.630  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; agegp.L         2.74449    0.63265   4.338 1.44e-05 ***</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; agegp.Q        -1.30504    0.57271  -2.279  0.02268 *  </span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; agegp.C         0.21175    0.43247   0.490  0.62439    </span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; agegp^4         0.07676    0.29202   0.263  0.79266    </span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; agegp^5        -0.19303    0.17627  -1.095  0.27348    </span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; unclass(tobgp)  0.20733    0.06837   3.032  0.00243 ** </span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; unclass(alcgp)  0.53660    0.07011   7.654 1.95e-14 ***</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt;     Null deviance: 23.273  on 87  degrees of freedom</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt; Residual deviance: 63.110  on 80  degrees of freedom</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt; AIC: 226.59</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt; Number of Fisher Scoring iterations: 6</span></a></code></pre></div>
</div>
<div id="computational-stability" class="section level2">
<h2 class="hasAnchor">
<a href="#computational-stability" class="anchor"></a>Computational stability</h2>
<p>The <code>fastglm</code> package does not compromise computational stability for speed. In fact, for many situations where <code>glm()</code> and even <code>glm2()</code> do not converge, <code><a href="../reference/fastglm.html">fastglm()</a></code> does converge.</p>
<p>As an example, consider the following data scenario, where the response distribution is (mildly) misspecified, but the link function is quite badly misspecified. In such scenarios, the standard IRLS algorithm tends to have convergence issues. The <code>glm2()</code> package was designed to handle such cases, however, it still can have convergence issues. The <code><a href="../reference/fastglm.html">fastglm()</a></code> package uses a similar step-halving technique as <code>glm2()</code>, but it starts at better initialized values and thus tends to have better convergence properties in practice.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">10000</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">ncol =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">y &lt;-<span class="st"> </span>(<span class="kw">exp</span>(<span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span>x[,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span>x[,<span class="dv">3</span>] <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x[,<span class="dv">4</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x[,<span class="dv">5</span>] <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10000</span>)) ) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="kw">system.time</span>(gfit1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fastglm.html">fastglm</a></span>(<span class="kw">cbind</span>(<span class="dv">1</span>, x), y, <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">"sqrt"</span>)))</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;   0.743   0.028   0.773</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="kw">system.time</span>(gfit2 &lt;-<span class="st"> </span><span class="kw">glm</span>(y<span class="op">~</span>x, <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">"sqrt"</span>)) )</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co">#&gt; Warning: glm.fit: algorithm did not converge</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#&gt;   2.857   0.091   2.952</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"><span class="kw">system.time</span>(gfit3 &lt;-<span class="st"> </span>glm2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/glm2/topics/glm2">glm2</a></span>(y<span class="op">~</span>x, <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">"sqrt"</span>)) )</a>
<a class="sourceLine" id="cb4-47" data-line-number="47"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-49" data-line-number="49"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-50" data-line-number="50"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-51" data-line-number="51"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-52" data-line-number="52"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-53" data-line-number="53"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54"></a>
<a class="sourceLine" id="cb4-55" data-line-number="55"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-56" data-line-number="56"></a>
<a class="sourceLine" id="cb4-57" data-line-number="57"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-58" data-line-number="58"></a>
<a class="sourceLine" id="cb4-59" data-line-number="59"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-60" data-line-number="60"></a>
<a class="sourceLine" id="cb4-61" data-line-number="61"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-62" data-line-number="62"></a>
<a class="sourceLine" id="cb4-63" data-line-number="63"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-64" data-line-number="64"></a>
<a class="sourceLine" id="cb4-65" data-line-number="65"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-66" data-line-number="66"></a>
<a class="sourceLine" id="cb4-67" data-line-number="67"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-68" data-line-number="68"></a>
<a class="sourceLine" id="cb4-69" data-line-number="69"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-70" data-line-number="70"></a>
<a class="sourceLine" id="cb4-71" data-line-number="71"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-72" data-line-number="72"></a>
<a class="sourceLine" id="cb4-73" data-line-number="73"><span class="co">#&gt; Warning: step size truncated due to increasing deviance</span></a>
<a class="sourceLine" id="cb4-74" data-line-number="74"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb4-75" data-line-number="75"><span class="co">#&gt;   2.107   0.069   2.181</span></a>
<a class="sourceLine" id="cb4-76" data-line-number="76"></a>
<a class="sourceLine" id="cb4-77" data-line-number="77"><span class="co">## Note that fastglm() returns estimates with the</span></a>
<a class="sourceLine" id="cb4-78" data-line-number="78"><span class="co">## largest likelihood</span></a>
<a class="sourceLine" id="cb4-79" data-line-number="79"><span class="kw">logLik</span>(gfit1)</a>
<a class="sourceLine" id="cb4-80" data-line-number="80"><span class="co">#&gt; 'log Lik.' -16030.81 (df=102)</span></a>
<a class="sourceLine" id="cb4-81" data-line-number="81"><span class="kw">logLik</span>(gfit2)</a>
<a class="sourceLine" id="cb4-82" data-line-number="82"><span class="co">#&gt; 'log Lik.' -16704.05 (df=102)</span></a>
<a class="sourceLine" id="cb4-83" data-line-number="83"><span class="kw">logLik</span>(gfit3)</a>
<a class="sourceLine" id="cb4-84" data-line-number="84"><span class="co">#&gt; 'log Lik.' -16046.66 (df=102)</span></a>
<a class="sourceLine" id="cb4-85" data-line-number="85"></a>
<a class="sourceLine" id="cb4-86" data-line-number="86"><span class="kw">coef</span>(gfit1)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb4-87" data-line-number="87"><span class="co">#&gt;  (Intercept)           X1           X2           X3           X4 </span></a>
<a class="sourceLine" id="cb4-88" data-line-number="88"><span class="co">#&gt;  1.429256009  0.125873599  0.005321164 -0.129389740  0.238937255</span></a>
<a class="sourceLine" id="cb4-89" data-line-number="89"><span class="kw">coef</span>(gfit2)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb4-90" data-line-number="90"><span class="co">#&gt;   (Intercept)            x1            x2            x3            x4 </span></a>
<a class="sourceLine" id="cb4-91" data-line-number="91"><span class="co">#&gt;  1.431168e+00  1.251936e-01 -6.896739e-05 -1.281857e-01  2.366473e-01</span></a>
<a class="sourceLine" id="cb4-92" data-line-number="92"><span class="kw">coef</span>(gfit3)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb4-93" data-line-number="93"><span class="co">#&gt;   (Intercept)            x1            x2            x3            x4 </span></a>
<a class="sourceLine" id="cb4-94" data-line-number="94"><span class="co">#&gt;  1.426864e+00  1.242616e-01 -9.860241e-05 -1.254873e-01  2.361301e-01</span></a>
<a class="sourceLine" id="cb4-95" data-line-number="95"></a>
<a class="sourceLine" id="cb4-96" data-line-number="96"><span class="co">## check convergence of fastglm</span></a>
<a class="sourceLine" id="cb4-97" data-line-number="97">gfit1<span class="op">$</span>converged</a>
<a class="sourceLine" id="cb4-98" data-line-number="98"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb4-99" data-line-number="99"><span class="co">## number of IRLS iterations</span></a>
<a class="sourceLine" id="cb4-100" data-line-number="100">gfit1<span class="op">$</span>iter</a>
<a class="sourceLine" id="cb4-101" data-line-number="101"><span class="co">#&gt; [1] 17</span></a>
<a class="sourceLine" id="cb4-102" data-line-number="102"></a>
<a class="sourceLine" id="cb4-103" data-line-number="103"><span class="co">## now check convergence for glm()</span></a>
<a class="sourceLine" id="cb4-104" data-line-number="104">gfit2<span class="op">$</span>converged</a>
<a class="sourceLine" id="cb4-105" data-line-number="105"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb4-106" data-line-number="106">gfit2<span class="op">$</span>iter</a>
<a class="sourceLine" id="cb4-107" data-line-number="107"><span class="co">#&gt; [1] 25</span></a>
<a class="sourceLine" id="cb4-108" data-line-number="108"></a>
<a class="sourceLine" id="cb4-109" data-line-number="109"><span class="co">## check convergence for glm2()</span></a>
<a class="sourceLine" id="cb4-110" data-line-number="110">gfit3<span class="op">$</span>converged</a>
<a class="sourceLine" id="cb4-111" data-line-number="111"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb4-112" data-line-number="112">gfit3<span class="op">$</span>iter</a>
<a class="sourceLine" id="cb4-113" data-line-number="113"><span class="co">#&gt; [1] 19</span></a>
<a class="sourceLine" id="cb4-114" data-line-number="114"></a>
<a class="sourceLine" id="cb4-115" data-line-number="115"></a>
<a class="sourceLine" id="cb4-116" data-line-number="116"><span class="co">## increasing number of IRLS iterations for glm() does not help that much</span></a>
<a class="sourceLine" id="cb4-117" data-line-number="117"><span class="kw">system.time</span>(gfit2 &lt;-<span class="st"> </span><span class="kw">glm</span>(y<span class="op">~</span>x, <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">"sqrt"</span>), <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">maxit =</span> <span class="dv">100</span>)) )</a>
<a class="sourceLine" id="cb4-118" data-line-number="118"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-119" data-line-number="119"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-120" data-line-number="120"></a>
<a class="sourceLine" id="cb4-121" data-line-number="121"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-122" data-line-number="122"></a>
<a class="sourceLine" id="cb4-123" data-line-number="123"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-124" data-line-number="124"></a>
<a class="sourceLine" id="cb4-125" data-line-number="125"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-126" data-line-number="126"></a>
<a class="sourceLine" id="cb4-127" data-line-number="127"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-128" data-line-number="128"></a>
<a class="sourceLine" id="cb4-129" data-line-number="129"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-130" data-line-number="130"></a>
<a class="sourceLine" id="cb4-131" data-line-number="131"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-132" data-line-number="132"></a>
<a class="sourceLine" id="cb4-133" data-line-number="133"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-134" data-line-number="134"></a>
<a class="sourceLine" id="cb4-135" data-line-number="135"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-136" data-line-number="136"></a>
<a class="sourceLine" id="cb4-137" data-line-number="137"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-138" data-line-number="138"></a>
<a class="sourceLine" id="cb4-139" data-line-number="139"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-140" data-line-number="140"></a>
<a class="sourceLine" id="cb4-141" data-line-number="141"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-142" data-line-number="142"></a>
<a class="sourceLine" id="cb4-143" data-line-number="143"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-144" data-line-number="144"></a>
<a class="sourceLine" id="cb4-145" data-line-number="145"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-146" data-line-number="146"></a>
<a class="sourceLine" id="cb4-147" data-line-number="147"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-148" data-line-number="148"></a>
<a class="sourceLine" id="cb4-149" data-line-number="149"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-150" data-line-number="150"></a>
<a class="sourceLine" id="cb4-151" data-line-number="151"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-152" data-line-number="152"></a>
<a class="sourceLine" id="cb4-153" data-line-number="153"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-154" data-line-number="154"></a>
<a class="sourceLine" id="cb4-155" data-line-number="155"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-156" data-line-number="156"></a>
<a class="sourceLine" id="cb4-157" data-line-number="157"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-158" data-line-number="158"></a>
<a class="sourceLine" id="cb4-159" data-line-number="159"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-160" data-line-number="160"></a>
<a class="sourceLine" id="cb4-161" data-line-number="161"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-162" data-line-number="162"></a>
<a class="sourceLine" id="cb4-163" data-line-number="163"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-164" data-line-number="164"></a>
<a class="sourceLine" id="cb4-165" data-line-number="165"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-166" data-line-number="166"></a>
<a class="sourceLine" id="cb4-167" data-line-number="167"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-168" data-line-number="168"></a>
<a class="sourceLine" id="cb4-169" data-line-number="169"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-170" data-line-number="170"></a>
<a class="sourceLine" id="cb4-171" data-line-number="171"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-172" data-line-number="172"></a>
<a class="sourceLine" id="cb4-173" data-line-number="173"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-174" data-line-number="174"></a>
<a class="sourceLine" id="cb4-175" data-line-number="175"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-176" data-line-number="176"></a>
<a class="sourceLine" id="cb4-177" data-line-number="177"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-178" data-line-number="178"></a>
<a class="sourceLine" id="cb4-179" data-line-number="179"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-180" data-line-number="180"></a>
<a class="sourceLine" id="cb4-181" data-line-number="181"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-182" data-line-number="182"></a>
<a class="sourceLine" id="cb4-183" data-line-number="183"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-184" data-line-number="184"></a>
<a class="sourceLine" id="cb4-185" data-line-number="185"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-186" data-line-number="186"></a>
<a class="sourceLine" id="cb4-187" data-line-number="187"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-188" data-line-number="188"></a>
<a class="sourceLine" id="cb4-189" data-line-number="189"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-190" data-line-number="190"></a>
<a class="sourceLine" id="cb4-191" data-line-number="191"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-192" data-line-number="192"></a>
<a class="sourceLine" id="cb4-193" data-line-number="193"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-194" data-line-number="194"></a>
<a class="sourceLine" id="cb4-195" data-line-number="195"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-196" data-line-number="196"></a>
<a class="sourceLine" id="cb4-197" data-line-number="197"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-198" data-line-number="198"></a>
<a class="sourceLine" id="cb4-199" data-line-number="199"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-200" data-line-number="200"></a>
<a class="sourceLine" id="cb4-201" data-line-number="201"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-202" data-line-number="202"></a>
<a class="sourceLine" id="cb4-203" data-line-number="203"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-204" data-line-number="204"></a>
<a class="sourceLine" id="cb4-205" data-line-number="205"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-206" data-line-number="206"></a>
<a class="sourceLine" id="cb4-207" data-line-number="207"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-208" data-line-number="208"></a>
<a class="sourceLine" id="cb4-209" data-line-number="209"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-210" data-line-number="210"></a>
<a class="sourceLine" id="cb4-211" data-line-number="211"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-212" data-line-number="212"></a>
<a class="sourceLine" id="cb4-213" data-line-number="213"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-214" data-line-number="214"></a>
<a class="sourceLine" id="cb4-215" data-line-number="215"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-216" data-line-number="216"></a>
<a class="sourceLine" id="cb4-217" data-line-number="217"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-218" data-line-number="218"></a>
<a class="sourceLine" id="cb4-219" data-line-number="219"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-220" data-line-number="220"></a>
<a class="sourceLine" id="cb4-221" data-line-number="221"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-222" data-line-number="222"></a>
<a class="sourceLine" id="cb4-223" data-line-number="223"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-224" data-line-number="224"></a>
<a class="sourceLine" id="cb4-225" data-line-number="225"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-226" data-line-number="226"></a>
<a class="sourceLine" id="cb4-227" data-line-number="227"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-228" data-line-number="228"></a>
<a class="sourceLine" id="cb4-229" data-line-number="229"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-230" data-line-number="230"></a>
<a class="sourceLine" id="cb4-231" data-line-number="231"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-232" data-line-number="232"></a>
<a class="sourceLine" id="cb4-233" data-line-number="233"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-234" data-line-number="234"></a>
<a class="sourceLine" id="cb4-235" data-line-number="235"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-236" data-line-number="236"></a>
<a class="sourceLine" id="cb4-237" data-line-number="237"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-238" data-line-number="238"></a>
<a class="sourceLine" id="cb4-239" data-line-number="239"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-240" data-line-number="240"></a>
<a class="sourceLine" id="cb4-241" data-line-number="241"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-242" data-line-number="242"></a>
<a class="sourceLine" id="cb4-243" data-line-number="243"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-244" data-line-number="244"></a>
<a class="sourceLine" id="cb4-245" data-line-number="245"><span class="co">#&gt; Warning: step size truncated: out of bounds</span></a>
<a class="sourceLine" id="cb4-246" data-line-number="246"><span class="co">#&gt; Warning: glm.fit: algorithm did not converge</span></a>
<a class="sourceLine" id="cb4-247" data-line-number="247"><span class="co">#&gt; Warning: glm.fit: algorithm stopped at boundary value</span></a>
<a class="sourceLine" id="cb4-248" data-line-number="248"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb4-249" data-line-number="249"><span class="co">#&gt;  10.944   0.376  11.344</span></a>
<a class="sourceLine" id="cb4-250" data-line-number="250"></a>
<a class="sourceLine" id="cb4-251" data-line-number="251">gfit2<span class="op">$</span>converged</a>
<a class="sourceLine" id="cb4-252" data-line-number="252"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb4-253" data-line-number="253">gfit2<span class="op">$</span>iter</a>
<a class="sourceLine" id="cb4-254" data-line-number="254"><span class="co">#&gt; [1] 100</span></a>
<a class="sourceLine" id="cb4-255" data-line-number="255"></a>
<a class="sourceLine" id="cb4-256" data-line-number="256"><span class="kw">logLik</span>(gfit1)</a>
<a class="sourceLine" id="cb4-257" data-line-number="257"><span class="co">#&gt; 'log Lik.' -16030.81 (df=102)</span></a>
<a class="sourceLine" id="cb4-258" data-line-number="258"><span class="kw">logLik</span>(gfit2)</a>
<a class="sourceLine" id="cb4-259" data-line-number="259"><span class="co">#&gt; 'log Lik.' -16054.15 (df=102)</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#example">Example</a></li>
      <li><a href="#computational-stability">Computational stability</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jared Huling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
